!function(){"use strict";function t(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function e(e,n){return t(n?[e[0]-n[0],e[1]-n[1]]:e)}function n(t,n){let o=t.dots;for(o.length>1&&(t.lineLength=(t.lineLength||0)+e(o[o.length-1],n)),o.push(n);t.lineLength>t.maxLength||o.length>30;)t.lineLength-=e(o[0],o[1]),o.shift()}function o(t,e,n){let o=t.dots;for(let l=1;l<o.length;l++){let a=o[l],i=o[l-1];e.beginPath(),e.moveTo(...i),e.lineCap="round",n(t,e,l),e.lineTo(...a),e.stroke()}}window.onload=function(){let t=document.getElementById("canvas"),l=t.getContext("2d");l.strokeStyle="white";let a=t.clientWidth/2,i=t.clientHeight/2;t.height=i,t.width=a;let d={dots:[],maxLength:150,maxDots:30},h=[];t.addEventListener("mousemove",t=>{let s=[t.pageX/2,t.pageY/2];if(0==d.dots.length||e(s,d.dots[d.dots.length-1])>=5){if(n(d,s),Math.random()<.1){let t={dots:[[Math.round(Math.random()*a),0]],maxLength:150,maxDots:30,speed:[0,4]};h.push(t)}h=h.filter(t=>{let e=t.dots[t.dots.length-1];if(e[1]>i||e[0]<1)return!1;let o=[e[0]+t.speed[0],e[1]+t.speed[1]],a=l.getImageData(o[0],o[1],1,1);if(255==a.data[2]){if(0!=t.speed[0])return!1;let e=[a.data[0],a.data[1]].map(t=>t/100-1.5),n=[e[1],e[0]];n[1]<0&&(n=n.map(t=>-t));let o=2*Math.atan2(n[1],n[0])-Math.PI/2;t.speed=[Math.cos(o),-Math.sin(o)].map(t=>4*t)}return n(t,o),!0}),function(){l.clearRect(0,0,a,i);for(let t of h)o(t,l,(t,e,n)=>{e.lineWidth=2;let o=Math.min(254,10*n);e.strokeStyle=`rgb(${o},${o},${o})`});o(d,l,(t,n,o)=>{let l=[0,1].map(e=>t.dots[o][e]-t.dots[o-1][e]),a=e(l);l=[l[0]/a,l[1]/a];let i=[0,1].map(t=>Math.floor(150+Math.floor(100*l[t])));n.lineWidth=o/4+5,n.strokeStyle=`rgb(${i[0]},${i[1]},255)`})}()}},!1),t.addEventListener("mousedown",t=>{console.log(d)})}}();
